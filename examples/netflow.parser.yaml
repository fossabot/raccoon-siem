# Name of a parser. Must be unique among parsers.
name: netflow

# Parser kind.
kind: kv

# Key-Value Delimiter. Optional. Default is '='
kvDelimiter: =

# Key-Value pair delimiter. Optional. Default is ' '
kvPairDelimiter: ' '

# Variables parser can use
# <resource_kind>:<action>:<resource_id>[<key>]
vars:
  - protoName = dict:get:ianaProtocolNumbers[RequestTransportProtocol]

# Mapping rule layout: [?] <Raccoon Event Field> = <Parser Field> [| s/ms/us/ns]
mapping:
  - RequestTransportProtocol = PROTOCOL
  - SourceIPAddress = IPV4_SRC_ADDR
  - DestinationIPAddress = IPV4_DST_ADDR
  - SourcePort = L4_SRC_PORT
  - DestinationPort = L4_DST_PORT
  - RequestBytesIn = IN_BYTES
  - RequestResults = IN_PKTS

# Rewrite rules
rewrites:
  - RequestTransportProtocol = $protoName
  - OriginServiceName = netflow