# Name of a rule. Must be unique among aggregation rules.
name: netflow

# Aggregation settings
aggregation:
  # How long (in seconds) to accumulate events before send aggregated one
  window: 10
  # Concatenated values of this fields must be identical among target events
  identicalFields:
    - SourceIPAddress
    - DestinationIPAddress
    - DestinationPort
    - RequestTransportProtocol
    - OriginServiceName
  # Values of this fields will be summed in a final aggregated event
  sumFields:
    - RequestBytesIn
    - RequestResults

# Target events specification
events:
    # Event specification virtual ID for internal use
  - id: flow_record
    # How many events should be accumulated before send aggregated one
    threshold: 100
    # Filter used for event selection
    filter: netflow
