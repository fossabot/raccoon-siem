name: json

connector:
  name: tcp
  kind: listener
  url: :2019

normalizer:
  name: json
  kind: json
  mapping:
    - sourceField: dns_response
      eventField: RequestStatus
    - sourceField: dns_client_ip
      eventField: SourceIPAddress
    - sourceField: dns_query_name
      eventField: DestinationDNSName
    - sourceField: dns_char_flags
      eventField: Message
    - sourceField: dns_ip_protocol
      eventField: RequestTransportProtocol
    - sourceField: servername
      eventField: OriginDNSName
    - sourceField: type
      eventField: OriginProcessName
    - sourceField: port
      eventField: SourcePort
    - sourceField: dns_direction
      eventField: RequestMethod
    - sourceField: dns_recordtype
      eventField: RequestUnit
    - sourceField: host
      eventField: DestinationIPAddress

enrichment:
  - field: OriginServiceName
    constant: dns

destinations:
  - name: storage
    kind: elastic
    url: http://localhost:9200
    index: raccoon-events
